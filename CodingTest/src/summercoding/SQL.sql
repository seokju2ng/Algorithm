SELECT USER_ID, COUNT(*) AS PURCHASE_COUNT, SUM(C.PRICE) AS TOTAL_PRICE
FROM GAME_USERS AS G
JOIN PURCHASES AS P ON(G.ID = P.USER_ID)
JOIN CHARACTERS AS C ON(P.ITEM = C.NAME)
GROUP BY USER_ID;
